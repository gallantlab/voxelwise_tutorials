
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Voxelwise modeling framework &#8212; Voxelwise modeling tutorials 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Helper Python package" href="voxelwise_package.html" />
    <link rel="prev" title="Fit a ridge model with motion energy features" href="_auto_examples/vim2/02_plot_ridge_model.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/flatmap.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Voxelwise modeling tutorials</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=gallantlab&repo=voxelwise_tutorials&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="_auto_examples/vim2/02_plot_ridge_model.html" title="previous chapter">Fit a ridge model with motion energy features</a></li>
      <li>Next: <a href="voxelwise_package.html" title="next chapter">Helper Python package</a></li>
  </ul></li>
</ul>
</div><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_auto_examples/index.html">Shortclips tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="_auto_examples/index.html#vim-2-tutorial">Vim-2 tutorial</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Voxelwise modeling framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="voxelwise_package.html">Helper Python package</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="voxelwise-modeling-framework">
<h1>Voxelwise modeling framework<a class="headerlink" href="#voxelwise-modeling-framework" title="Permalink to this heading">¶</a></h1>
<p>A fundamental problem in neuroscience is to identify the information
represented in different brain areas.   In the VM framework, this problem is
solved using encoding models. An encoding model describes how various features
of the stimulus (or task) predict the activity in some part of the brain. Using
VM to fit an encoding model to blood oxygen level-dependent signals (BOLD)
recorded by fMRI involves several steps. First, brain activity is recorded
while subjects perceive a stimulus or perform a task. Then, a set of features
(that together constitute one or more <em>feature spaces</em>) is extracted from the
stimulus or task at each point in time. For example, a video might be
represented in terms of amount of motion in each part of the screen
<a class="reference internal" href="references.html#nis2011"><span class="std std-ref">[3]</span></a>, or in terms of semantic categories of the
objects present in the scene <a class="reference internal" href="references.html#hut2012"><span class="std std-ref">[4]</span></a>. Each feature space
corresponds to a different representation of the stimulus- or task-related
information. The VM framework aims to identify if each feature space is encoded
in brain activity. Each feature space thus corresponds to a hypothesis about
the stimulus- or task-related information that might be represented in some
part of the brain. To test this hypothesis for some specific feature space, a
regression model is trained to predict brain activity from that feature space.
The resulting regression model is called an <em>encoding model</em>. If the encoding
model predicts brain activity significantly in some part of the brain, then one
may conclude that some information represented in the feature space is also
represented in brain activity. To maximize spatial resolution, in VM a separate
encoding model is fit on each spatial sample in fMRI recordings (that is on
each voxel), leading to <em>voxelwise encoding models</em>.</p>
<p>Before fitting a voxelwise encoding model, it is sometimes possible to estimate
an upper bound of the model prediction accuracy in each voxel. In VM, this
upper bound is called the noise ceiling, and it is related to a quantity called
the explainable variance. The explainable variance quantifies the fraction of
the variance in the data that is consistent across repetitions of the same
stimulus. Because an encoding model makes the same predictions across
repetitions of the same stimulus, the explainable variance is the fraction of
the variance in the data that can be explained by the model.</p>
<p>To estimate the prediction accuracy of an encoding model, the model prediction
is compared with the recorded brain response. However, higher-dimensional
encoding models are more likely to overfit to the training data. Overfitting
causes inflated prediction accuracy on the training set and poor prediction
accuracy on new data. To minimize the chances of overfitting and to obtain a
fair estimate of prediction accuracy, the comparison between model predictions
and brain responses must be performed on a separate test data set that was not
used during model training. The ability to evaluate a model on a separate test
data set is a major strength of the VM framework. It provides a principled way
to build complex models while limiting the amount of overfitting. To further
reduce overfitting, the encoding model is regularized. In VM, regularization is
obtained by ridge regression, a common and powerful regularized regression
method.</p>
<p>To take into account the temporal delay between the stimulus and the
corresponding BOLD response (i.e. the hemodynamic response), the features are
duplicated multiple times using different temporal delays. The regression then
estimates a separate weight for each feature and for each delay. In this way,
the regression builds for each feature the best combination of temporal delays
to predict brain activity. This combination of temporal delays is sometimes
called a finite impulse response (FIR) filter. By estimating a separate FIR
filter per feature and per voxel, VM does not assume a unique hemodynamic
response function.</p>
<p>After fitting the regression model, the model prediction accuracy is projected
on the cortical surface for visualization. Our lab created the pycortex
<a class="reference internal" href="references.html#gao2015"><span class="std std-ref">[p3]</span></a> visualization software specifically for this purpose.
These prediction-accuracy maps reveal how information present in the feature
space is represented across the entire cortical sheet. (Note that VM can also
be applied to other brain structures, such as the cerebellum
<a class="reference internal" href="references.html#leb2021"><span class="std std-ref">[14]</span></a> and the hippocampus. However, those structures are more
difficult to visualize computationally.) In an encoding model, all features are
not equally useful to predict brain activity. To interpret which features are
most useful to the model, VM uses the fit regression weights as a measure of
relative importance of each feature. A feature with a large absolute regression
weight has a large impact on the predictions, whereas a feature with a
regression weight close to zero has a small impact on the predictions. Overall,
the regression weight vector describes the <em>feature tuning</em> of a voxel, that is
the feature combination that would maximally drive the voxel’s activity. To
visualize these high-dimensional feature tunings over all voxels, feature
tunings are projected on fewer dimensions with principal component analysis,
and the first few principal components are visualized over the cortical surface
<a class="reference internal" href="references.html#hut2012"><span class="std std-ref">[4]</span></a> <a class="reference internal" href="references.html#hut2016"><span class="std std-ref">[8]</span></a>. These feature-tuning maps reflect
the selectivity of each voxel to thousands of stimulus and task features.</p>
<p>In VM, comparing the prediction accuracy of different feature spaces within a
single data set amounts to comparing competing hypotheses about brain
representations. In each brain voxel, the best-predicting feature space
corresponds to the best hypothesis about the information represented in that
voxel. However, many voxels represent multiple feature spaces simultaneously.
To take this possibility into account, in VM a joint encoding model is fit on
multiple feature spaces simultaneously. The joint model automatically combines
the information from all feature spaces to maximize the joint prediction
accuracy.</p>
<p>Because different feature spaces used in a joint model might require different
regularization levels, VM uses an extended form of ridge regression that
provides a separate regularization parameter for each feature space. This
extension is called banded ridge regression <a class="reference internal" href="references.html#nun2019"><span class="std std-ref">[12]</span></a>. Banded ridge
regression also contains an implicit feature-space selection mechanism that
tends to ignore feature spaces that are non-predictive or redundant
<a class="reference internal" href="references.html#dup2022"><span class="std std-ref">[15]</span></a>. This feature-space selection mechanism helps to
disentangle correlated feature spaces and it improves generalization to new
data.</p>
<p>To interpret the joint model, VM implements a variance decomposition method
that quantifies the separate contributions of each feature space. Variance
decomposition methods include variance partitioning, the split-correlation
measure, or the product measure <a class="reference internal" href="references.html#dup2022"><span class="std std-ref">[15]</span></a>. The obtained variance
decomposition describes the contribution of each feature space to the joint
encoding model predictions.</p>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, Gallant lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/voxelwise_modeling.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>